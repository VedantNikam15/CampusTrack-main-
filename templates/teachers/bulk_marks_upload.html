{% extends 'base.html' %}
{% block content %}
<div class="max-w-xl mx-auto bg-white p-4 rounded shadow">

  <h3 class="fw-bold mb-3">Bulk Marks Upload</h3>
  <p class="text-muted small">Upload an Excel sheet (.xlsx) that contains Student ID, Subject, Marks.</p>

  <form method="post" enctype="multipart/form-data">
    {% csrf_token %}
    <div class="mb-3">
      <label class="form-label">Upload Excel File</label>
      <input type="file" name="file" accept=".xlsx" class="form-control" required>
    </div>

    <button class="btn btn-primary">Upload & Import</button>
  </form>

  {% if results %}
  <hr>
  <h5 class="mt-3">Import Summary</h5>
  <table class="table table-bordered mt-2">
    <thead>
      <tr>
        <th>Student ID</th>
        <th>Status</th>
        <th>Message</th>
      </tr>
    </thead>
    <tbody>
      {% for r in results %}
      <tr>
        <td>{{ r.student_id }}</td>
        <td>
          {% if r.exists %}
            <span class="badge bg-success">Found</span>
          {% else %}
            <span class="badge bg-danger">Missing</span>
          {% endif %}
        </td>
        <td>{{ r.message }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
  {% endif %}
</div>
{% endblock %}
